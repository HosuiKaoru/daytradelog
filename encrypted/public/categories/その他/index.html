<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"052d640fc0361276947747c563a7731031dc9cf6dfb3efb8f399c37e236fa86521dcfb7d122c53d6231069b051d5d31831370677a28888d99c1bdecb549cc020b2bbafd0e7c47dd586013621117b33df7272250a2d1a52e7f89ac1cce7acd48e3c7aea330793ab513e1e2e8affaf49af24b28350200323dff7280f6fe76423b5272c6c3717c6e6dcb92a2147d72d6fdc6e76725029f35e16f5d7044d9dc333e02c064e835c6ca8f2c393967f78ffac6c61a42b70422a9d9ab7caf4844edd96fe5d5d986aa4f21c80dd262d5960e998fa38b045766c7bb3b38857dda5615fc78f78d5962fd2e2f328fc53442e6e864dc3b45e570d30976ca534a24b68d39e9f8b3506ece73e7b634fb5bc554e3df9830f098fe0a4a6631cdf87dd2339f3aef5c1635289af517989d94ed2d5bbcd1aab3b43fce9917903607103d44c22b593f7f87895e9dceae773f6c768f8d407d72957cd7327cf80a3ba6a15ce8c7ad837782f81af71879d0126febe7f3e9963581e9eeadd1c0a4efc229bcf3e97409d50ef7b6b9172b042f8b0e0fea237a9d2cd9934cefdc4360b832038fa52eda1bec58dcf501ba82abded2542757a040787bde6953d585d9ea9abf88f0c8700d62fff05e6faf4b9e9f4d2388e8325abe24d2c1a54bf66d7b7dfd1eb5270c72bf10bcb0880328360e3320024227f948f4af98e588fe4a83adfbe933f88107d5bf4b64791a268354fb75b0883387ff3550518938d4bd5e7b047212759daf554d426ecd58aeb6c5ae3193a07f933173232f81b81810c1a4db86dc3a5e6231e7dbf2780ec77eefe2eaf732570610b7effc1f2bb03b26cfda51e9ca1af7b3a47a52fb655ec55a93104bcbe38a183f267d256a4463d248b36ee5274d21c1322ccd8a002c5b58d733196a9ee0e2c35a550ea698cd7a779435e9020f934662183c30f92e7b0a771eb30d5d39493c89a87411ae083c90cb0525450cb1ac9038abfed486de6d3a703366d4af30854b68d69015fe72a29d61d8196728316f35ce47bf2b34cdaa87528a0cef1beb2571e96249446665d30349c14c86e76b65d2b7bb26b274cb075fe5e6e141ed8dfa09395b594fec6070ecf5a43429a64e23525d1f180ec0dd765ad23097caea327a09b9c93005eaf58e4bc58bf86a917b24ee50687501b934edd1ce0783b3d6ddf972337cf396250ed07dc2007922f169db66d3e9d0fdd44bf520c31f9005320669f969c1608f494d0091885088fb8459794912582b8b08e70834269ca15f59ff4ba6ebd691b11cc5feb0c4186d23a9db6d594c97b55e2c022bdb292dddbce2d556bfd44ef59d894d747d9246db344d622b93029f3b18976c3bc9d551d69f6a99e822251b3deead3557133bc25a1757fca9887572acc3e2fb1935e549a49e8ee036b915e327c13213d29fd7e0f8ea3f6a50144fab4b79ded850b8db794273e3ccdfdb99d73ec77717003620d405a70405813d6b8ead4f7c8bd62bdaa0240473b5e697541804ef38851282c4ecaf5e18ac6ef091012cab7e07628de6bce825c6d8e32a0a1c48d0191159fbe3de6df89087cad0fab99ae3a28bf909702b88acc5c5f057f9a974dfcf1280bee76e9545bc34f6f3744b1a889a0ca5a3b7cbfcac4c362446f1374de9c4503b38e812de3d5e49ca3a36a2224d53e14c876202fc17ffacbfee1bf30a256ee65fe1898b9f80942d50eb968987805bb9d0a756d1e3354bbe7e628c6b8540b187bc44500e4582f6cd480afb7e11da504604c41d69296f0ca9af18e3e785534df2b82b2710043586d002631ca7efa9ca14c6df1d066ceb7587a8f2132e31657bf617b2aee15a6703187aefb6c1c69d9ccbbb1e681f082bff7cf6583fe1e394c270b83b58edffe3fa36318d1335be5bc2dcc222625bc5c6fc96bb9442f7047661390ae028620964ac2ebcb425d6272b650f43163a80b5917ee1dcb72e9af39f22975f569ca2cb3e3474386e598e93fce50a90ad56e4faee2eb6e54a0ade6f380b7664fc80dd7af68d1c39fccf669899f76edec272328b9c58ffcd4667664cbfb2a151c0713beda6c1b051390f3fc0ccb81ce80ae078c44da606497249a5c8fd88d5967cced76bad0f61ec9a8a32bc85af4c52ff1fa8979c8b30deaa9bddfdc2c98518390249ed8a78d839b5186182af837fe83c27ce265a688993c4c83f0332e732370ada5c201c4e88626a3a0652d586140ad5f426a1ddb37bb88be7511051b3625582f81816a1d39e0e9fa0716c92a93bcab0d9dd3bcd2890f9a1ca288f9c92c2ae629de59d63bc4dced21f100c887eecb1208579177ee5d9de83799f5664065b5abf73436c8686ad008474c07f418201669ad51976a4164623f885b88e85506970ab178c08d91b19efb512478f1439415c7215878bf00721e43e6b2aa3282d4636fff64754a7db05af942d256b97598971c4f8f9a1ac7cc922c461f0ac9ae4e7f4004461b2ce58205a718a111a6e6c52a2aa38d10ca5d546ac2bb55c5d45abfc405059e0c4c9ca8b8aca1e04c44a524cba25321b71e84b697bdd621d7f012a8a494b51bee10106da0fb7e250605a154336e100bbec442b5897160972e0896f0800511e349bf6dfe82f4eb645c1683faaef80806fa560911c6bdcaa8c435877c6678fccbf3ac26adc37f72ec07da6ed29f0d133115a9ca2eb02d43edc70cb5bbbeb78063a3b4c4ae9ca79af94d68d88dab5fc4ac962902db608e263d29dfb79189cc80461ec327124f195a4897ad3537efdf9dae439273134f9e7204809acaaea617552ce1c2b267cca25d3c87c4280790d011e32b5cfea87d8daee8008cce62f71b6ba903548941873f2fddc64f90492909f769bb48eb409fb1d57888acf99b2346561b631b2dff7d395ba8f6e994850bdcca7b041a7b99f174c3e11878489b3746ba8e29eb476946a2bec8c0dec70547715d0c52b74d15981158f2ad26cc5faf77e81bd8060b3fa0db7ebb37b8323253a1c44c395455c2f10faa352c5b6d4ce86fad79320b0ea2968113e84dc4f7fb12272140bbdca81f95fedb0603557330c66f8ada2af60c6f2339aa5bd0d00444b602af43512c78a3398b18904143ba97ac702091abddd6e1a7a725e1c6ea0bd728ebaf7640c07160b12a7a9af4ff9edcf7020fec6b2739245f7ce7b5f6d4b0780ed324eed2b9d43c66e34a211fd34de459d96d46022abb41775201f1e49f620016faf3f8e5ddda9e6d086b1b04ea2975e65b57b2905b320fde8f65359ddde441097d1e9c2612dba088e72cd9709b3b3b44db946dee02a8fe7879e86b2c2dee5b8d4b786c7e705888988b42fac87835459b3615968365caf224a990aeff40225c9de4e2d5ed4bc9b30b204158121763073bbbb14970499059cc65055f9db3bc6d4b929a0b21b9072c5dd93d40fd93d6b9d89485a5dbce8fbfbc286823049e024c3376508b852f20783041161e87a379635aeee3a0bf593ea60b4f20f182302f3a6621da4adc72d95f429788f8e03daa87039cfd518696023f8146c6556306fe577fe0b35b614eebb81c29e1c52af16c8314f550fa92477d07c844804491b20791bc5899096bb6e8eedde475b39ac0a20c475a36ac3ba72178b50f024d3c74f167d7ea4087112730e659b0cfe6e1038bad19454a472ae3c7c8d4877a23f70b38cdb3f57d36541b3a896d1ded019ac30161226763d976d48972c236ccdef3b9230a95619fefd91ee2812d220188f8be55584126a25b9e60f440dbfc19821b6f22e400de107ae566a614a615e00eb79ef62eb48a851ee91bc94d8b7448d85180094c05ae7fb82d12cfb6eb1c7c4896abc0ce900206b8daa8e4ed6463e638b617fca9ee9925bccfce7c328beac3baff082b0cc07bf90ecc576023f447535b54854e795266b467f714bf97936b8d0f9946fa23208e774c50754c54ab7b8aaafdcd3590044a0007eac9022b0869f34c8d74cf9876a739f80733a98665aded1cd9ac8090267c66514941e87b4fe23d600d0655df2b535dda39b04acacb862bdf116cc62ac3acc14614060bd37e649bc2bcdc68ec2049f24ae990862b4317e744f3cdb2bdaee68fcb6133e4dcb75c3bde52ebcf4ec7ab46eed17a306de2bd384dbb5e0b04d78c90631a3a4c5323ff2dde4f0669bf4663625e9f14cac94e3ea7c213d4173c8f2f28a6c51b9b3dab95b67a44fc1072b21e6b03ad6aabc99e472e3f4646b6e5ed12d0381fc73abd2defb1ec929892dec28904301b01b5951af2a2a92bd439ac60c74da1e5ef20dee1d4146ae43a17036066d8cb61008789f760a53f3801ea4eef5f02b52628ac31292188031be3591025b0e091817602641266ed6ade553a465c2db348fe63c65d9f6225828a38a9038ed4ed76c6bc4d85f844d8993d44791c3ea1658e513b5f893df11126906d5f4114fae382e240fb833612ca41f10df4f58e10d88ba1391730b7cfce8200af22bd3d08fd2ed12a3eab5a128bdc7006eafc3f133aa9a1619b27a31e3da7d6c69ca28f61ad629061877b48ffd9d0bdbfec5d6b8e3f5aef2d74db2b048e549686ca27cb7d1e55de665c562e6697cda22ae6689098cd51f0fc48d3ac3fe87609fed657b8f473f78d927f29c6eae6195b14d9686b892c402fcf572a24a1886be7d16179f1bedda9347afc09b4576f982aff97efc1666600ad152e24096074a8d3f32542f1a9d9a78c70d99ac845a53f4ce293f2769493034fa5839ceb2c4a0a55d08f80aa0801f81f16236bf3675b1bce4c87dd959fb8220fee168525b310c66c77e5e58ec45a59af4ed6fa512f2b62788bd0085318b44b9be5f3c10eacb36e58b5eeaf9c5d15893372812a7111c55ba1ad03b5bf603d4a58fe9bd81b048413067cc42af5087d1975fb4bf1b556fb5a3e12e63884b134339d2b4e0ac7b9066924d5db7b8d74e2b72c45e774f661aad2d60565d71db901e84f8fb96b6ecd3ec0012c7f05e3186a7de9f35ff5245fcbbadaf9d81501a8b7b0ff883f8e7c507a611a8e28cba01045000564e647c2a3f1052901cb4f27cba38ae2f8d7b3f026bd784c3f0d419deb3fceac7b7c0f9f918352efbfb26477e79e507596c413af42050d0f9003a0db750198afd3e30ac7d764673244c8261909db32f65788c64e873cc88899cae9e1df5836db337f08ca38296852052a2f0fe4dc203a928214e8da9bf2671e0d7181e5402c36a2d06ad4b524dbc2c57e6225d0445dbc5324a603e7c13db2260f6938e86a388c0db8adf62f9baf97111b71579bbbc1147c97927699370c174f2f41df375a522518a2a7da74dec82587007d0dd478ef561859b53f279fa8e2ed28af8601f1c7f8bee7c35a52424abe949c9e59d4ff0a1026b0c24da857056961566c64b3180f83c9d95c4cc2b2fb09e12cd133492e1423db049a6bf96eb261b498398ed4beddd39529d11761bb088c887c6b130dfe7ccf542116d6b586afe402a95aecec12caee370ab3cda03c2df89a25900e02a8b9db584841609203b84f649ad5137345f8663b6cd4c10a3c5d44ea011bd8d8968046be1c184f9d3efa1a61ca6d02808d034f5859628a12f59c3447843788a1c0938c8736f62fc93509098cf451a0423dd66eb8a779035730d8041a187725527795f54a7dff22c3e433bb7bfff871fb61306560274f86a756853032deba426e197c65cebc8b676e78ecc5c88e3a92102541e6441429810c8b2482b3a96906ae988a71e00fd83a6a4dee74e79b9979a89ac1df63637d8e79a9f856abd8df926eade1e50218180152747b70ac670bfb94cd4f9a55bc1f651b299f9e1e6baad703e16138b1929e16980b062049714efab4964bf447c53230f0bfcae69b806044684b2a49544505384831f7d84b30412e40fa1a84676ffe86677aad5bf0afd03c90fb90dbf97e436557113c5b5c38c4fbb1b1846787324098137cd05e6e0efc6db08f88a06cf735021252bfceb21f9f5e3b09ead773a330cfd43d2405d5d36e42a35bf22e09d17656710040b1f909b59ec624387d6a33915d1221aa03b075b7591eca6e1f18f9f0355456c9b037ad341f4721380d1b1a817dbf952712c82684aa2af8398563ca0f850fe26b0658d608d0315787a7c1935b359ac2e4fa9939b0396001a2ff1a4b6d1ef3934e9991815ba4042ecc814c1f1eda83e2d70a87fbf86ad3096afdaf2fe2cff426c4999fb11cd1ec9bf466d2da18458a22492e62da2eb03bc500ebda8a460dfaf2f953d3a5fa74e0eeb5c216f2b47f38ac1aa3556fa40bd57312174d9da6360099528bf009fc3e4924e96366292f82ab70c74f5590d17d2c3f3724c88add23dc9686c9d69c4efabce20af3d26fb2b190f8f798c9fc98bae3f7cbf166533b74f3b835277d4bd70bda64b912f062da97c2304ae766ffe0a3c5b90ce00830a41d156e453131124fb9adaaf78c7ce1d581034fa3049286c787a6e1efb139f50c138db7ab0e12d19b817324ccb834d2fcf78d8515c6fd2285ac189eb31870fce1a63b8bf9592ec843008ab8d353fc3ccaee0bdc86893ee012cdf840e1e4fb9e4e9bd22b35469aa7430c855227c9bbe3d251cc4e87fc08f28090c68f13fbcc4967bf26741afc7315f676bf904404e02af2d6623206cf988e176a2e91d2b42b0489d70dc0735472ba78f8eedef8b08f0a2b0bfd55fcce8623ad167ac2b01096d8165070b0caf244e84e2cacd99469856b02f26fe18dd2979b4a2c8af164a425b877c07696160463cee753d82295d8168f11b4224100625937d4f482e72ff3fba9de41ef36f1ef69233be756b047701822f5730820d2d20c5ceda4c248afd7c035064a0c44325871f08e44b6cc776f7478a0ea572819a7400cf8f44cfed2ac58da5724dd630746aee46ead955c7c4bed2dd3a3d59428b65468fc5e369fc7676c6e2ede525858a203d0681ce6347b7f236547a68acf879c95e651f3443ade9a37ebff2d7c4350d95d55287c68fddac3f6fd8c046745ddac48faa753b120bb5bcfa37e2d5133074f46d54b08fbc3a29887f9c4981679cd712dfc8fa64fc6008f4801f840e08aef58a1aba6462f0155d9d9c309bed5a96fb738570aaa07bfd22587436b80d551243ab704336de9a87b51e2f0aa5b6eac2e86e8722de90a667d754764901dbb6a4349c59ad6fd4dba7a3ac4c0eabf2919fc7f3e070878a2d25833118c1bce1958987140aa2648d777f6e2440643b946781467afb81ccb65a97d48fc084f57e3bdf8705b7a6291917355c3256c3d27ce873cc390eb97015ebcc7a4670b45a048cf3e1fdd9278e2cd89ae5dfb4c3519b7df8e337cb9f5f73caeb305826cb6a94e20dcbc84f24fd78bbdc7775f84aab420f2fbe5f11e8a06387db514f9b7c1fa65f6934b4d998396c4546aca0d9cbc52cc7b17bcc674bdb6dd44911d38f481bfb2c2438648518d55473b759e62b43667d3f24ccee47aa95a86ce758546871a2240a04e1b0ff1c83bb3b78160089b51625f742d19a5daacb09573171cbf8678e879dbbcedec87345f614eda5712ecbb87cb24c038d753ca036d679c3993128c022ae7eaa5ac519e22ec5283be3010e03173186a7f70835023a88523f396e995294f0c2aa0445eeb1878f12e8019f166a54a9bd8fdeaa6122ad3e0657736599fc68ee77697d1d64d848eab4cbac7db5f13a9bb6f86633cc446094a00efda5157c17477496865ba090d2e48de77860fb4f9999da112df60858ade1ca27e931a2345af0b29f9543b3088fa5d7cc59eb4c42cd3d0863c2d4a1e163d282f2eb9b855ff8bd901bb1c04a8db2e56063773ade3da6651bcf62f04630b4d12788e1e794a46c1e28e6fb3251b51d2224af6d7d736e46b08c8a28a96caf1c902ed2511978834451b4c541c199d1551a396e58744a793046af8e9a0b89d1088ceeb76ae1742b2ab031eee1263c83e4bb12d7902b17cdfb20b89328455a675c3728d2da9d6e0786f4852df4b255be3ea06476b40a87e65a7e14a585e6e3c9256bd61fa1c13b724ac402089b2fc1c2c6264a3ddacc3abf83a6902525d04fd65cf5981951b7e4dab3fc1118890bae64c6a3c53ec414b7afb9554c8d12f5ef2560aef9c5ccd334772a6e76b39f58fbef186115479008133dfbf4928956bd01e2fa0335091fccdab90ad896a2ec9e8152700fb939f3cc019b2cac918be606fbd428b160180a042bf4cab25025afdb535679bd86e733b26b056401cdde852ad6fb941ca5f74a50ac6319c8b92a61579f7874f60891ff1595abb85ebd37b682c7cc0a58e8107055d4f06c6f85577fdb370528a212d691f25fdac192563b0586850621ea6dcf252a643204bb4311135538105f41b1b9070f980a59cfa4d39f0153aca342551acf1eb182823894fe5e55423fe3de5019841155650894a00997a0e1d02b1064b6e0db310e4dbafb3a147871be44fb0263cb70463703274c02da369b1d78c7b5b3c73985b98d9a7f44e79d1e980297b24d6d9408be0536055285400a9efb7b8e16b153854c470f6693a8e2f33aec80e540c76af9a3b63c4074b67f84ea55c19f63c4141951947a1d53de7d69daddcf71ee0fbe3168159f3552a2a153326c2855d9f288ffa6eb32bd6b5d0880e3ad99c9bacb52b8085bc694b84f5078f6b83c12af41433cee78c9e02219a945c43b6638b3acc67a9b6cba3c45c13baa4aa23cf4733100f7cdd7d31acc5b6d6bfa5c8c7cb25e995756129260ab11f37530c15868e3281ca7e43f47a61d635d0d57ff63985a8fadb83db2540552ce9b629a9e68983d71dce7d059fe086a9940c9de0c4a1d8eabd160fda6dce20faac155e0103ca90ca50b97253593fd9203801f2d453599b106fe3ea72a66ad995cebed0108a7fea680b4581977dc9cd04565ff53801dcbbc4f72492eeedfe1227ef9d26a21d0f4471d5f0c7a5f5d4e484ecf37fbffd35bb8b00363cd4a4499083bf7b5f2d818775f029bb9973f199121b6002d4869e56d1b94caddb246c82a23ae7a3b143e6c8e0633906c6435199b53b30e223dc193fd79bfe7e516fd5cacc5aeeb33ddce93ff73f95299beabdb0b1c492551baad8455fd28982733ad42566b41983912b77cd416893631c3f9d1bd440aaac2f03a7aa8f4baf8b620f2d1d1e46ed139ec7721380f804c26479261c2b5c077561de6ea9b58f9d5105917de11c93d2762d778d862402a0509131d9f70b01df94484e5e6c2cef9567fe0257e2c06862199fc2732b225aafaf363323e629db229a33408fd5e5aa2265c284fce059c00fa56a1e1a643de2c6a3a153943dc09234feb64638432ae326a339571cf3d6b82b858513935c171c535e45102f4e807da31b93c6caa297c3799ae136ec0a2c517f22baf9cdd241b2634bde44f1c394eb2dae10f492a4480d5b919fbfec56284bae3866a5be3ec7eb749a37afc63fae8bee40117dfa54bf5bec27bbe9972bb7aaeb7b853d00a4cbf153b4b8fb66e4136b4d39b74e34981cf126e5c66e1ff68f9c17ff7560585d17e381407df4ae8341e8a7c7ec91b28e275912c3883a6cf5c45e9020ecbb69a364ad5e3a45d5f4c52a4b3ef2867a80dcd3146b220a98183f842d14a3ef69e9d984a407b7afb6db3d2eeb297d4fde704e54c03b600a7b588c7de7f39260e5b6c30648e85c5bef2d47f89145d63658db4c8ae3824b356f84114bd01f429166e8674cecb2af5ebd13b7106870d332d322fdc6ed3c2439b26cfa3cabc6f8705f3727620a1289a35be5a9a35c2269d2eacc95c0036b70eaf283756d33f3f1067a7ddb86d95c96e8ff6e1cfb9e73eb7aac8d022338e779222d5a64788e98540f83f6481e1efab6eb9cdb3b657d984a9e92e5aebd95bd5ee11502fe459f40935bd165cf5097c9a79ac77d6c373be9b1712bef3defcdbaeb41b713cb58fbc58b91e18b236a131b012d21c887492b63593c053cc2f1da8f43fd8c1addfd99d6e0dfd320e6b73d1940f3724432a99794a5dff7461790d159a117969196808db17324e83efa974b0b2965abb0bb5232e57b0487c53d519168dc45ec4603e78281c2c9dad737823206c6fe7a3d82818be0bb4110f6f38a7eaa88f21609b802031fe111295ff22630f53d60525aeaea9776fbdd21d7a05f744d005ceecb9fd3b90f1aad58c58edc5f16c74a9c0dbe35caa9a0ee1999fd145d70608508f03b57e74b987e81382f9a8249de41cda38763e06d9cf15dda95029040ba00ba8cc484bb372351f034c0a6d5f32b912398c67de1045e9c07b03fa61ccc5644ce7dcfed1eec347d23a44f1629322de535ecba01986fcfb15375edd4bf0be959f38c542174ffd1d23b7792228c7efa2fcf291667da803cc36636bffddc6442e00618202ef65c521db8d4e0739484f9b472d2bd53fb2c7f8736aa9347cdc7ed217cfa9d6d27d910af5189affd276751918409f06815ee2cfd16a7b43575c18701f8098b2dd46180baeddfd8443735ff6d26aaabd5eaab5ce72849008d35e92e21bdf4a42618660dd2189dbc31f7a7a770bf3e6906cb4e824db6e387b624b39d0ce044561bb8912c17053b72ad3d58b11c30f7e820b72f1c3ec3bec83fc06aa376733e0388cadba659f890f67e17ddcaef4e00a47b23ef12e4477bec7fdba6845a2e17f30a730f5e97395b4c4c98bd083f91885d91507a562b08c1b0d8a7723911dc6a36520cef226fb27fc4a55d2562546a9248975803b8ae2cea217a6fbc9d0a164b96e2230da7603d4e21e792ec69c8e016d8b073425bb9d6d6a1ead6b90654fd2cd52105d9a6de63558c69ac357b91d6c3e62441138c4c781c91fa159052ac786bd1ba8b9fcb21d118d9044659ad17e343c8d19f754f1319ce9447e6dd0df9a1a990334b39e625221d649fafdfe89aec90a45159d418c34f505b867f1bf39c77d778e98ecd7eccf3ec3ea6709e9172f674902676ee8867f15789162f1167a29c546ea3446ee07e4da61b1bf043d6b10ebaaa2fdfd4cd3a1501be3a71ac2c2b66a0cbb79f1cf2d8f28290869679a9c6c5590369c7caaa1c97511dfc3145e8f31f8f20a8f10081b7b840470dc2499c49e72586fc3d010c1fff68757fe85fe400f2b1e0b5fa7310e10d8c84ac3cc7630692382e429d8c024409e1b40a05c9656799a78ad59d24deea86cf55a5b8660ac0c4adf0ed0dfd29e14e2cee811c947d4986b2b9ed2d75bae7ff31601f3d1112d31412dfec46dd3a2736002ed5c6d1769f73c127445c1d2086bd2979aea41ec0784047cca93e954b8b6dcd44f7fcc01b7455b7e0bb531345bf31b5ab9caea69dd035ac1f3e6a2b1dae25ee2f4917763e739688656d6abb65edf34cfbb3625f8f4acfe5ef86d5ab02583993bf5c87034bac396d91f3b8f842e943e72bd343f9e496cb86fe92bf65978880ab7bc77a1663e2161316ef263b53bfe835b83c86eaa29eea3ffa38fd15e568256d8b7a20a0d2e97ca63731d87c6ae70b9c5e9fbf27b3bd083ba1837616290e74284b7497c5d48c1623c2deb68c2f75d2b664d1a6756fad8fa4227269796378ff6d8184734272d1a0ff2acc5ae2d0b6ffe3cf5b5c3b74862b814f22967c32ff456da4767fc7989d9832548f01772a3ea2cbf637e83738814ec8edf1e95b8f484d8a328031c442f0fff56d3d7d1e5da372dc2aca55376cf8c3290e71a6ac19309fc8b03bc40455beb891b245e27f32458d16544d21ba198a6668c6dbe3b1968dc047621f274221c48df6752669e2fe618dcc336460148dd7750e28394970e3fd8ea24782f2525fa0f34140070fcf9e2b77d850bdc138c946b1589d47243645025ae8914d8bd0dcbe69da43869baa7f51c621966069b270d94c7f12d707f3438b37699844d94a912a87cbf4c2da0f1a807f982eeec52672c7011fd895c97ba22a4d21255b6ca288a094dba38decf14382cad48d989b499698a0fc0539b101d268603b74eaf5b11ae54f7581d1a2a1c3f9d328dde2bd3926cb98e3f9db61113b2572558584634446bad649f53b2c1503a575f3e239bbfd658fe040247517069e110daf43e01333c828bb538123984825c221ab317105cb4877afe85b4075042a73a2f83012705a91f5f17d7c63eee2e87ed6f19eb0c7593508f15f519bb87233137945587ef563cbdcc412cd5a04fac6089412a334e3a23822d40ad5553ce777e0df8d42ddaa3122395ec6df3b1c4166cd78e4bb4ebe2ef3d3bab0d62dd632a3b312d0b84e387f1c5c6c14c322404056e07ea57cbd013e9ea1ccff511564e4e190858de6152f532b2a5ba2a056b84b0b1ec3044a9b4bfe1c94662581219cdf399a6ba655fd1647b755a8f907ccd1626c96fa4172779926763de859ca205fbdafd97d4d01ad5b8a8b58ee7134e623f98b98c1348c718c7e49685d5af3644e6d5526f0cc9aafba37293f70c2faf31bdc3043e155b8897d2b46cf79a23fe31932799f2306c81a79532229882a33a5d920225a3d64719840dca75f11296d33cdfbc76a28cc443f8ba0068f7e4ecd5271fd209306af1414b33458b6a61d29a79e415e67c83c375cbf7a3441f74bed819c4071fd00b729c89af0aebfc030e53dc454dd1ec9136f9cc78bceb9dd696dcfe031907662462715eed08c88d7bb217dd02d57c0651f6cdf2ef721a2ab99abe77dc130ea4029b9de38d7ca679e1eecc4d32791d846b5640f74dfd0b0925dae2ab820666ee9a264bb352c61bb3d55e5591f485e08c1860a431baccbd83031ec99819bfd54e20060b4603e1fd7ffc8dee4988d9a92b054630f2512809009caf61c1671960fe6a2376700f127944560621f8716d8e08b41550fbcfbc084e2259cf0b4985d5357fa073be897bc9cd309ef9139649c3f298804e4389530d3e3b3f61ba89cc5aa0e266b245b3d08f44293c2e05a9162d9be2e13ca02e13882289104ed177dd20437585271cd60a64c5804f8519da973437d294cfadf7a254fb0815af749d70f7beb9fb19d0af81dd75711b0c6e82fcffbd125b1e734741716ee7989040558d8cb59b142aceb58ae58614e669aefbe808bbfa35292356eef9156bf62665309a29f871d4234eef9f7280ed16754031ddca8036af327713ec12e561e9fa00b112ecd342b406607c7307d35b1d303cc9929acdaffc982879f4e15869cd57e3e37f123ade8c6dacf525f25fcb8fafb96bad66f00e3fb8d23061e9835b32518d5624e1e731db3a5dfbf6be0a9d59b523ad98bddb0e4621f7f3167c7c1ce70659b9dc4fe4f22447e75d76beb718b070c14a26fb148710521b20b14ed958c343f269cd4e13c4e2f5eab0ad61562e709b7c4c9a5a9599f9cc15b497a0d22566bdd891d6a7a6838f6e448612beabdec640f08c37a408b649fe6eca2bccd5fcd71bb1770971e095c848e75b0b92fa22c4354d239185aafab392c6e76fe72cc83c9593d8fa1261a16fc0359e05a7c0acf19c093d919d470b0c9a1559ba3c779a695ceb3666b9d69bf6a545af50c6dc6bea467f0aea15c42de0531b1812361958dd70391fddcebda2f3763726eb9b7c5406f027274dbdf39a1c6ffa476d07e919bb2ad1a68c309ba8f5ebc8dde99f9cdae89f8a894147e56db7366d0ac3132fbc81ff149fb13e68f5961175a14804ccd4e9fb2358425562f5e8564a6c02d0b9d87dea277ed5efaaa70aa4f3850a5539e32f67a85374cecc50b4a0049ead9333465ee34a5776d6b48d80261844a21d2fb0fc548cb6b7614a06df4480d71cfb6e113973a8662c56ded0a471255b9e5a7e492c35a66089454d567d523c9c37b557a3d4b5c2323065171c63fdbf7f652c9b5fc51599d7e91ebe6816446bef5fa984b59970ea206a9cdd9175b5234ea34ad97aa3eeb607d9dea78f61fb6214bdc14e511eed87e5d88ebff3b349ccf9e87f28f4cd65a06258f1d2e19d5d54a42c6ff1403ccaade7451fa34bc455832870cbb58e542c51e745d6eacbdf1b1f60bf5665bbeaf6005a0d304b296ff28d8981fbdc6c36e12738db1966c9083077c6a54b79728dd562a15e590d0eb6683152eb553618b96817a9cdec5dae6e948d15903bb98cba4ac4f2814461a073fca525395b544fc50b1939cc5baa256098f9ca78b65cc55fe03d4bb507b867841e469d701e08a0203994b252cb54d19d76db89f15b0594abda0571c0b08e5efd0d74594031e7e5f93cbf26194073a202a3eb64bdd86aef272fa1d1272f45e6d69ad7f504c700ba56708c5a0d2f273bacc275a8185cb0a0e1c10b04674c0a1b7afbdac4297c44645d20a56859446c8c6c08d767fe07848f350a2c774ccf1fa483cbcd652fc6051950b25eeaa5f866a9091c294be9b625dbdd28b9c1345f2719002d90a03d96af46c2853f7ae01e2aaca8fbe723bf3ae771138f12a0badd24f1544c02ea532de22d536e348ee59028d7b881f9b48b853f02f6d56a251915850852c884403ad8b18dfe8afd96c393334c8ebe2d42627ca530e4e8d9c5bff082e93ee0dd6f8c1ca00ca22aa2a982337681b01610b6beefd99cc4031ec401ad8615095ad4c767e2ddb6611674cf8f5983528c24c98dd08f90909f307bfb86e1f97ecbde8d61b0ff68919b5794f9193511953c68d4e0a54803755d992427f39dd4d9f941f6bb850048373bf759b5e734751c1d096ca83143f060518a0e834aa484fed3fdd2b18a8c885fff408d50e5ee50d3ccbaa4aca6359c605fbc50a0cb3bdd19c3c4fdf43207f9badee1e41f07ec49c12b1c17df176f732c462a5a384606dce620faec071f25c151f5477a14be59f9c127fb23f3659ac56bb9896605669cde0d90d0641afd832e31d4ff7a679260e958bb4854d421777d4cc4920cbe74dfe0633d5877cfca1bc3c31f1d421e171408fb5c1c06093b71803998041d817cd92acc7d0a16fcc7c6463b6114fac711016d7aa9698f823eb982fb84642177bd8c82c290627775c0f5190c765f76ab3cfec18ebc94a08311bc05ec40b29fe7c51d00202fe4ffc85210dca08545bd3d9f715fa48f5b86181f8718feb0d3e960f18a9c2351651d0bf15ff8d40f0af78c1e3943a6a90f4a394cb82d59c59506e8a2b2fb895aa63c960019fc0bb6bdb8af72d85ec2bbf95d922bc5cac4bdaa300e8ae84a02bfd65d125719b7757c04526e3fd4f54f38ecff4b4ff80c959215929f8313dbc72ba856a031a413c7c9c999ceaec5105e044391aeef7abd45fa3dd72764aa3fe3af3f360bedda241cf469444e917464e7ca78c3d5cd06b02db6a8027d9b661d9aea6fd07a9b19e6802629d3f4523637cbd7a2ea12abe0cb60e91b436ac669b260af8a43f5a0b564dfdf7026e2c61df36b4e4afe54f57bedc53b3f1b5c6bef34f6957748830d713d11ec20762299bad41b948dddc924ca9d2098d83c592ba9ee8c4609e89b4e0415ef8c69e7347b17bb6a0c9977e0046234fbd5105a10f0c81fae342e08fee2f0e2c4f9a9d684f09a485c5a4d54c12f64bee3dd6b8d7c939b8ed7625aebe4559571fe05d86ced82ad114beaab7fa18f72aeb8449b141410e2a2c0da4eb09b560d95efaca93b2e220ea3571d2835854462b0ce3b75449b0d90f02c7ed467e17d02843e1e4c92c3f8a4fa77d1358e3107b4fe0c0be36b5e2eb72eea3aa0a2d9f81997b125b0b7ff43f629b16c7095dcbac3e0b2ab4ced14c6fe54755a89cc4f5ce57eca695a16428288c0cb5cb119105183a904dd5878a71b17ff11ecbdaf27bd1d80ec45a491e19f7f77d9cb3819858ce7fbe75b2817d861dd15b09635d464c5f4531ecb1126206a7a4cfa79da5ca3b182022c158d7fcc61abd4ef13bd1f0291a25a37580a5cfc9360f85541e9748ee0efc49af08946c7a36f9df8ba3b16d1c4592b622fe4447133cfdb942e408146706d8067ad6c6044f7a46d1134ad930a0fbbb777beb1954484f1ee2f4323a88f8dd96c88e3c227bea465d9a2575cf0254278cb2baaf0969d1f18c329f3d90500320a5b00135e893538345b30f4cf42a804b39a8e56f5908418a33355b48e19b22fd1d3b93c86d8333686e381a83056cf3b7e0d7c686579db1bdc788f14dc28c8ca8b66d3e4de611509a85db80a3145f9d4ca531d75b44d727cd306a1c31ca7ced875df98e747af01b1826b7e06fb85c0bffaef092119b88491bf4e2477956d96aca176b9440d9a1190ed95512f8b1c47d05ccc3077aa5bc911c3099d5e31577bd578bc559d6a8ccccfb9d66d9fa1c299a14ef8fa18683a3f64acf9bb4bd71612363593fbe2e3bdb525f44488ab153fc5b8bb7608fb49b5c91ad1811a2e7f513f033a1f3e6ac2797fc6e9e998fa69e81a673dbbac39e833ab2daaabe700eba996eb0c69cfc67d9af0d229ac2e7a67dc93c3a3d400ea8c6d980165eddf37febb747a8d66e4a98d73d67d93527cc059187fec2ad67de632554b95a7978fddeae2a0ebb38765a5a28385bf19751345663f42fda7687281506aa84a1ce833652583660908b95de9f33ae891d15b29bc6661af8fb8a78a17bf2d98c3940aea0dd2bf6f2f7eb5b6e241f1ebc64c6bbd5cf8fc81efb031fdb19d6296583853d335e40ef1236f1a236dd6524b86665f491516667c3011516169baa476eeeb4b559cabacbfb4fb6dbde0bdcb0fcce5b2199cf0a63a58a10662d48ae324d46b409ead51e432476a3967354c8bc8021bc6f7085dec6a536fa1c70342e88acf8fbb0c501c70f3835413d781347ccad0566997848348ca1f594e7a30c31d4f12873e1163632034461793b103687a73a41deb9ffc27be81508e0fc212d42a4e52fb6169ba7529378d4c365ca3eeebea814c01d145937ee508626a5ab06acac2c1f2de4910fe49b7f514344db20d1db4a21f561b26bb7f1916946055233eed66bc14b59e8e7e2e2c8cc97d190d225a582accb0a6f4c966e76805e30ded478d54a743265893bc21e55aa07594ba25bece04c06458b7854166e77f605348464c526f138b4373174f5e4faf45264161c3d336344193f97d11884d2d0260854634d3530d446d7deebe2db5625fa6ad5967d427a43add7a7e11433136e32c19e30f9d880794d68200678666d3a5bd3eb88038dd468308c8f43d4f12bb77ac79817af8e9b78a07cd34346b2dc2b09154563ca43fc76df45c2e8ded4ebf971ee5198f3b4030daf16081bb93305001151b73df81cf5e50c5b16ad55824630a28e4e266ad8f6ea731ead1cd120f0396576dc8ad3c6346ca2c31c1a100dd1fa164df72e3e391c23828bb3a641ad08d4376d715474ca8c53297202712c7017135e93ddebbaecdadf567d1f9cf25cd57cea13e578a2f25425fa6704a859f8f4c14f57a6d6a613bb214adab8194e6d007484e47ef3f244801008e9c5787f","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"414a6f51bebf16788608c4a5ab2bffa2"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
